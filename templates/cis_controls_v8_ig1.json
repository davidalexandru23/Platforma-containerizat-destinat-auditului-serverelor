{
    "$schema": "bittrail-template@1.0",
    "metadata": {
        "name": "CIS Controls v8 Implementation Group 1",
        "description": "Template de audit inspirat de CIS Controls v8 IG1. Controale esentiale pentru orice organizatie.",
        "version": "1.0.0",
        "type": "CIS_CONTROLS",
        "author": "BitTrail Platform",
        "createdAt": "2024-01-01T00:00:00Z"
    },
    "controls": [
        {
            "controlId": "1.1",
            "title": "Inventar active hardware enterprise",
            "category": "CIS Control 1: Inventory and Control of Enterprise Assets",
            "severity": "HIGH",
            "rationale": "Este imposibil sa protejezi ceea ce nu stii ca exista. Un inventar actualizat e esential.",
            "automatedChecks": [],
            "manualChecks": [
                {
                    "checkId": "1.1.M1",
                    "title": "Documenteaza inventarul hardware",
                    "instructions": "Furnizeaza documentatie cu lista tuturor activelor hardware (servere, workstations, echipamente retea).",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": false,
                        "requiresApproval": true
                    }
                }
            ]
        },
        {
            "controlId": "2.1",
            "title": "Inventar software autorizat",
            "category": "CIS Control 2: Inventory and Control of Software Assets",
            "severity": "HIGH",
            "rationale": "Software neautorizat poate contine vulnerabilitati sau malware.",
            "automatedChecks": [
                {
                    "checkId": "2.1.1",
                    "title": "Lista pachete instalate",
                    "command": "dpkg -l | wc -l",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": [
                {
                    "checkId": "2.1.M1",
                    "title": "Documenteaza lista software autorizat",
                    "instructions": "Furnizeaza lista software autorizat si compara cu cel instalat pe server.",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": true,
                        "requiresApproval": false
                    }
                }
            ]
        },
        {
            "controlId": "3.1",
            "title": "Protectie date - identificare date sensibile",
            "category": "CIS Control 3: Data Protection",
            "severity": "CRITICAL",
            "rationale": "Protejarea datelor sensibile previne breach-uri costisitoare.",
            "automatedChecks": [],
            "manualChecks": [
                {
                    "checkId": "3.1.M1",
                    "title": "Clasificare date",
                    "instructions": "Documenteaza cum sunt clasificate datele pe acest server (public, intern, confidential, restrictionat).",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": true,
                        "requiresApproval": true
                    }
                }
            ]
        },
        {
            "controlId": "3.4",
            "title": "Restrictionare accesare date sensibile",
            "category": "CIS Control 3: Data Protection",
            "severity": "HIGH",
            "rationale": "Accesul la date sensibile trebuie limitat strict.",
            "automatedChecks": [
                {
                    "checkId": "3.4.1",
                    "title": "Verifica fisiere cu permisiuni largi",
                    "command": "find /home -type f -perm -0007 2>/dev/null | head -10 | wc -l",
                    "expectedResult": "0",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": []
        },
        {
            "controlId": "4.1",
            "title": "Configurare securizata enterprise",
            "category": "CIS Control 4: Secure Configuration",
            "severity": "HIGH",
            "rationale": "Configuratii default sunt adesea insecure.",
            "automatedChecks": [
                {
                    "checkId": "4.1.1",
                    "title": "Verifica SSH PermitRootLogin",
                    "command": "sshd -T 2>/dev/null | grep -i permitrootlogin || grep -i permitrootlogin /etc/ssh/sshd_config",
                    "expectedResult": "permitrootlogin no",
                    "checkType": "COMMAND"
                },
                {
                    "checkId": "4.1.2",
                    "title": "Verifica SSH PasswordAuthentication",
                    "command": "sshd -T 2>/dev/null | grep -i passwordauthentication",
                    "expectedResult": "passwordauthentication no",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": []
        },
        {
            "controlId": "4.7",
            "title": "Management conturi default",
            "category": "CIS Control 4: Secure Configuration",
            "severity": "MEDIUM",
            "rationale": "Conturile default sunt target frecvent pentru atacatori.",
            "automatedChecks": [
                {
                    "checkId": "4.7.1",
                    "title": "Verifica conturi sistem cu shell",
                    "command": "awk -F: '($1!=\"root\" && $3<1000 && $7!=\"/usr/sbin/nologin\" && $7!=\"/bin/false\") {print $1}' /etc/passwd | wc -l",
                    "expectedResult": "0",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": []
        },
        {
            "controlId": "5.1",
            "title": "Inventar conturi",
            "category": "CIS Control 5: Account Management",
            "severity": "HIGH",
            "rationale": "Conturile orfane sau nefolosite sunt un risc de securitate.",
            "automatedChecks": [
                {
                    "checkId": "5.1.1",
                    "title": "Lista useri cu UID >= 1000",
                    "command": "awk -F: '$3>=1000 {print $1}' /etc/passwd",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": [
                {
                    "checkId": "5.1.M1",
                    "title": "Revizuieste conturile active",
                    "instructions": "Verifica ca toate conturile active apartin angajatilor actuali.",
                    "evidenceSpec": {
                        "allowUpload": false,
                        "allowLink": false,
                        "allowAttestation": true,
                        "requiresApproval": false
                    }
                }
            ]
        },
        {
            "controlId": "5.2",
            "title": "Privilegii minime",
            "category": "CIS Control 5: Account Management",
            "severity": "HIGH",
            "rationale": "Utilizatorii trebuie sa aiba doar privilegiile necesare.",
            "automatedChecks": [
                {
                    "checkId": "5.2.1",
                    "title": "Numar useri in sudoers",
                    "command": "grep -E '^[^#].*ALL=' /etc/sudoers /etc/sudoers.d/* 2>/dev/null | wc -l",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": [
                {
                    "checkId": "5.2.M1",
                    "title": "Revizuieste privilegii sudo",
                    "instructions": "Verifica ca doar utilizatorii necesari au privilegii sudo.",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": false,
                        "allowAttestation": true,
                        "requiresApproval": true
                    }
                }
            ]
        },
        {
            "controlId": "6.1",
            "title": "Colectare log-uri",
            "category": "CIS Control 6: Access Control Management",
            "severity": "HIGH",
            "rationale": "Log-urile sunt esentiale pentru detectia si investigarea incidentelor.",
            "automatedChecks": [
                {
                    "checkId": "6.1.1",
                    "title": "Verifica rsyslog activ",
                    "command": "systemctl is-active rsyslog 2>/dev/null || echo 'NOT_ACTIVE'",
                    "expectedResult": "active",
                    "checkType": "COMMAND"
                },
                {
                    "checkId": "6.1.2",
                    "title": "Verifica journald activ",
                    "command": "systemctl is-active systemd-journald 2>/dev/null",
                    "expectedResult": "active",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": []
        },
        {
            "controlId": "7.1",
            "title": "Protectie email si browser",
            "category": "CIS Control 7: Continuous Vulnerability Management",
            "severity": "MEDIUM",
            "rationale": "Email si browser-ul sunt vectori principali de atac.",
            "automatedChecks": [],
            "manualChecks": [
                {
                    "checkId": "7.1.M1",
                    "title": "Politica acces email/browser",
                    "instructions": "Documenteaza politica de utilizare email si browser pe servere.",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": true,
                        "requiresApproval": false
                    }
                }
            ]
        },
        {
            "controlId": "7.3",
            "title": "Remedierea automata a vulnerabilitatilor OS",
            "category": "CIS Control 7: Continuous Vulnerability Management",
            "severity": "CRITICAL",
            "rationale": "Vulnerabilitatile nepatched sunt exploatate frecvent.",
            "automatedChecks": [
                {
                    "checkId": "7.3.1",
                    "title": "Verifica unattended-upgrades instalat",
                    "command": "dpkg -s unattended-upgrades 2>/dev/null | grep -i status || echo 'NOT_INSTALLED'",
                    "expectedResult": "install ok installed",
                    "checkType": "COMMAND"
                },
                {
                    "checkId": "7.3.2",
                    "title": "Verifica update-uri disponibile",
                    "command": "apt list --upgradable 2>/dev/null | tail -n +2 | wc -l",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": []
        },
        {
            "controlId": "8.1",
            "title": "Audit log activat",
            "category": "CIS Control 8: Audit Log Management",
            "severity": "HIGH",
            "rationale": "Audit logs furnizeaza trail pentru investigatii.",
            "automatedChecks": [
                {
                    "checkId": "8.1.1",
                    "title": "Verifica auditd instalat si activ",
                    "command": "systemctl is-active auditd 2>/dev/null || echo 'NOT_ACTIVE'",
                    "expectedResult": "active",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": []
        },
        {
            "controlId": "8.5",
            "title": "Retentie log-uri",
            "category": "CIS Control 8: Audit Log Management",
            "severity": "MEDIUM",
            "rationale": "Log-urile trebuie pastrate pentru conformitate si investigatii.",
            "automatedChecks": [
                {
                    "checkId": "8.5.1",
                    "title": "Verifica logrotate configurat",
                    "command": "ls /etc/logrotate.d/ | wc -l",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": [
                {
                    "checkId": "8.5.M1",
                    "title": "Politica retentie log-uri",
                    "instructions": "Documenteaza politica de retentie a log-urilor (minim 90 zile recomandat).",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": true,
                        "requiresApproval": false
                    }
                }
            ]
        },
        {
            "controlId": "10.1",
            "title": "Antimalware instalat",
            "category": "CIS Control 10: Malware Defenses",
            "severity": "HIGH",
            "rationale": "Protectia antimalware detecteaza si previne infectii.",
            "automatedChecks": [
                {
                    "checkId": "10.1.1",
                    "title": "Verifica clamav instalat",
                    "command": "dpkg -s clamav 2>/dev/null | grep -i status || echo 'NOT_INSTALLED'",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": [
                {
                    "checkId": "10.1.M1",
                    "title": "Documenteaza solutia antimalware",
                    "instructions": "Descrie solutia antimalware folosita (poate fi la nivel de infrastructura).",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": true,
                        "requiresApproval": false
                    }
                }
            ]
        },
        {
            "controlId": "11.1",
            "title": "Backup date",
            "category": "CIS Control 11: Data Recovery",
            "severity": "CRITICAL",
            "rationale": "Backup-urile sunt esentiale pentru recuperarea din incidente.",
            "automatedChecks": [],
            "manualChecks": [
                {
                    "checkId": "11.1.M1",
                    "title": "Documenteaza strategia de backup",
                    "instructions": "Furnizeaza documentatie despre strategia de backup (frecventa, locatie, testare).",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": false,
                        "requiresApproval": true
                    }
                }
            ]
        },
        {
            "controlId": "11.2",
            "title": "Testare restore backup",
            "category": "CIS Control 11: Data Recovery",
            "severity": "HIGH",
            "rationale": "Un backup care nu a fost testat nu e de incredere.",
            "automatedChecks": [],
            "manualChecks": [
                {
                    "checkId": "11.2.M1",
                    "title": "Evidenta ultima testare restore",
                    "instructions": "Furnizeaza evidenta ultimei testari de restore backup.",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": true,
                        "requiresApproval": true
                    }
                }
            ]
        },
        {
            "controlId": "12.1",
            "title": "Firewall perimetral",
            "category": "CIS Control 12: Network Infrastructure Management",
            "severity": "CRITICAL",
            "rationale": "Firewall-ul controleaza traficul si reduce suprafata de atac.",
            "automatedChecks": [
                {
                    "checkId": "12.1.1",
                    "title": "Verifica ufw activ",
                    "command": "ufw status 2>/dev/null | head -1",
                    "expectedResult": "Status: active",
                    "checkType": "COMMAND"
                }
            ],
            "manualChecks": []
        },
        {
            "controlId": "13.1",
            "title": "Monitorizare si detectie",
            "category": "CIS Control 13: Network Monitoring and Defense",
            "severity": "HIGH",
            "rationale": "Detectia timpurie reduce impactul incidentelor.",
            "automatedChecks": [],
            "manualChecks": [
                {
                    "checkId": "13.1.M1",
                    "title": "Sistem de monitorizare",
                    "instructions": "Documenteaza sistemul de monitorizare folosit (IDS/IPS, SIEM, etc).",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": true,
                        "requiresApproval": false
                    }
                }
            ]
        },
        {
            "controlId": "14.1",
            "title": "Training securitate pentru angajati",
            "category": "CIS Control 14: Security Awareness and Skills Training",
            "severity": "MEDIUM",
            "rationale": "Angajatii informati sunt prima linie de aparare.",
            "automatedChecks": [],
            "manualChecks": [
                {
                    "checkId": "14.1.M1",
                    "title": "Evidenta training securitate",
                    "instructions": "Furnizeaza evidenta ca echipa a participat la training de securitate.",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": true,
                        "requiresApproval": false
                    }
                }
            ]
        },
        {
            "controlId": "15.1",
            "title": "Management furnizori de servicii",
            "category": "CIS Control 15: Service Provider Management",
            "severity": "MEDIUM",
            "rationale": "Furnizorii pot fi un punct slab in lantul de securitate.",
            "automatedChecks": [],
            "manualChecks": [
                {
                    "checkId": "15.1.M1",
                    "title": "Inventar furnizori cu acces",
                    "instructions": "Lista furnizorilor care au acces la acest server sau la datele de pe el.",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": true,
                        "requiresApproval": true
                    }
                }
            ]
        },
        {
            "controlId": "17.1",
            "title": "Plan de raspuns la incidente",
            "category": "CIS Control 17: Incident Response Management",
            "severity": "HIGH",
            "rationale": "Un plan predefinit accelereaza raspunsul la incidente.",
            "automatedChecks": [],
            "manualChecks": [
                {
                    "checkId": "17.1.M1",
                    "title": "Documenteaza planul IR",
                    "instructions": "Furnizeaza referinta la planul de raspuns la incidente.",
                    "evidenceSpec": {
                        "allowUpload": true,
                        "allowLink": true,
                        "allowAttestation": false,
                        "requiresApproval": true
                    }
                }
            ]
        }
    ]
}